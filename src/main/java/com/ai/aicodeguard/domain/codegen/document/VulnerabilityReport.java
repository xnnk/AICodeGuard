package com.ai.aicodeguard.domain.codegen.document;

import lombok.Data;
import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.mapping.Document;

import java.time.LocalDateTime;
import java.util.List;

/**
 * @ClassName: VulnerabilityReport
 * @Description: MongoDB中存储的漏洞报告
 * @Author: LZX
 * @Date: 2025/4/18 13:45
 */
@Data
@Document(collection = "vulnerability_reports")
public class VulnerabilityReport {

    /**
     * 报告ID
     */
    @Id
    private String id;

    /**
     * 关联的代码ID
     */
    private String codeId;

    /**
     * 漏洞列表
     */
    private List<Vulnerability> vulnerabilities;

    /**
     * 检测时间
     */
    private LocalDateTime detectedAt;

    /**
     * 漏洞详情
     */
    @Data
    public static class Vulnerability {
        /**
         * 漏洞类型
         */
        private String type;

        /**
         * 代码行号
         */
        private Integer line;

        /**
         * 修复建议
         */
        private String suggestion;

        /**
         * 严重程度（HIGH/MEDIUM/LOW）
         */
        private Severity severity;
    }

    /**
     * 漏洞严重程度枚举
     */
    public enum Severity {
        HIGH, MEDIUM, LOW
    }
}
