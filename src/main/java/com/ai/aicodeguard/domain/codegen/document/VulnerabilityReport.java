package com.ai.aicodeguard.domain.codegen.document;

import lombok.Data;
import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.mapping.Document;

import java.time.LocalDateTime;
import java.util.ArrayList;
import java.util.List;

/**
 * @ClassName: VulnerabilityReport
 * @Description: MongoDB中存储的漏洞报告
 * @Author: LZX
 * @Date: 2025/4/18 13:45
 */
@Data
@Document(collection = "vulnerability_reports")
public class VulnerabilityReport {

    /**
     * 报告ID
     */
    @Id
    private String id;

    /**
     * 关联的代码ID
     */
    private String codeId;

    /**
     * 扫描时间
     */
    private LocalDateTime scanTime;

    /**
     * 使用的扫描服务类型
     */
    private String scanType;

    /**
     * 漏洞列表
     */
    private List<Vulnerability> vulnerabilities = new ArrayList<>();

    /**
     * 总结
     */
    private String summary;

    /**
     * 代码安全得分(0-100)
     */
    private Integer securityScore;

    /**
     * 漏洞信息
     */
    @Data
    public static class Vulnerability {
        /**
         * 漏洞类型
         */
        private String type;

        /**
         * 漏洞描述
         */
        private String description;

        /**
         * 代码行号
         */
        private int line;

        /**
         * 列号
         */
        private int column;

        /**
         * 问题代码片段
         */
        private String codeSnippet;

        /**
         * 修复建议
         */
        private String suggestion;

        /**
         * 严重程度（HIGH/MEDIUM/LOW）
         */
        private Severity severity;
    }

    /**
     * 漏洞严重程度枚举
     */
    public enum Severity {
        HIGH, MEDIUM, LOW
    }
}
